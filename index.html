<html>
	<head>
		<script>
			function submitt() {
				const val = document.querySelector("#sha1-input").value.toUpperCase();

				[...document.querySelectorAll("form > *")].forEach((e) => e.disabled = true)
				const result = document.querySelector("#result");
				result.innerText = "Checking ...";

				const prefix = val.substring(0, 5);
				const rest = val.substring(5);
				fetch(`https://api.pwnedpasswords.com/range/${prefix}`).then((res) => {
					return res.text();
				}).then((text) => {
					const lines = text.split("\n");
					if (lines.some((line) => line.split(":")[0] === rest)) {
						result.innerText = "COMPROMISED PASSWORD!"
					}else {
						result.innerText = "This password should be safe";
					}
				})

				return false;
			}
		</script>
	</head>
	<body>
		<div>
			<form name="form" onsubmit="return submitt()">
				<input pattern="^[0-9a-fA-F]{40}$" required id="sha1-input">
				<input type="submit" value="Check hash">
			</form>
			<div id="result"></div>
		</div>
	</body>
</html>